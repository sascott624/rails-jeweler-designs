<%= render 'layouts/messages' %>

<h1>Stone Details</h1>

<ul>
  <li class="stoneName">Name: <%= @stone.name %></li>
  <li class="stoneWeight">Weight: <%= @stone.weight%> ct </li>
  <li class="stoneCost">Cost: $<%= @stone.cost %> </li>
</ul>

<div class="stoneDesigns">
  <% if @stone.designs %>
    <h2>Stone Designs</h2>
    <ul class="designList"><% @stone.designs.each do |design| %>
      <li><%= design.model %> <em>by</em> <%= design.user.email %></li>
      <% end %>
    </ul>
  <% end %>
</div>

<a href="#" class="js-previous" data-id="<%=@stone.id%>">Previous</a>

<a href="#" class="js-next" data-id="<%=@stone.id%>">Next</a>


<!-- <% if current_page?(stone_path(@stone)) && current_user %>
  <h3><em>Add a new design:</em></h3>

  <%= form_for @stone.designs.build do |f| %>
    <%= f.hidden_field :user_id, value: current_user.id %>
    <%= f.hidden_field :stone_id, value: @stone.id %>

    <%= f.label :metal %><br>
    <%= f.collection_select :metal, ["White Gold", "Yellow Gold", "Pink Gold", "Platinum", "Sterling Silver"], :to_s, :to_s %><br><br>

    <%= f.label :model %><br>
    <%= f.collection_select :model, ["Necklace", "Bracelet", "Earrings", "Ring"], :to_s, :to_s %><br><br>

    <%= f.submit %>
  <% end %>
<% end %> -->

<script type="text/javascript" charset="utf-8">
  $('.js-next').on("click", function(e){
    e.preventDefault();
    var nextId = parseInt($('.js-next').attr("data-id")) + 1;
    $.get("/stones/" + nextId + ".json", function(data){
      $('.stoneName').text("Name: " + data["name"]);
      $('.stoneWeight').text("Weight: " + data["weight"] + " ct");
      $('.stoneCost').text("Cost: $" + data["cost"]);
      if(data["designs"].length > 0){
        var l = "<li>";
        for(i = 0; i < data["designs"].length; i++){
          $(".stoneDesigns").show();
          l += data["designs"][i]["model"] + "<em> by </em>";
          console.log(data["designs"][i]);
        }
        l += "</li>";
        $(".designList").html(l);
      }
      $('.js-next').attr("data-id", data["id"]);
    })
  })
</script>

<script type="text/javascript" charset="utf-8">
  $('.js-previous').on("click", function(e){
    e.preventDefault();
    var prevId = parseInt($('.js-previous').attr("data-id")) - 1;
    $.get("/stones/" + prevId + ".json", function(data){
      $('.stoneName').text("Name: " + data["name"]);
      $('.stoneWeight').text("Weight: " + data["weight"] + " ct");
      $('.stoneCost').text("Cost: $" + data["cost"]);
      if(data["designs"].length > 0){
        for(i = 0; i < data["designs"].length; i++){
          $(".stoneDesigns").show();
          $(".designList").text("goodbye");
        }
      }
      $('.js-previous').attr("data-id", data["id"]);
    })
  })
</script>
